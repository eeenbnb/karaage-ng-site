# NgRxを使用する。

## install
```bash
ng add @ngrx/store@latest
```

`app.module.ts` に上書きが入る。
```typescript
...
import { StoreModule } from '@ngrx/store';

@NgModule({
  ...
  imports: [
    ...
    StoreModule.forRoot({}, {})
  ],
  ...
})
export class AppModule { }
```


## 概要

NgRxのライフサイクルは以下の通り  
![NgRx01](./assets/img/2021/05/23/01.png)


`action` を定義し、`reducer` でStoreの値を操作するロジックを定義、`store` に登録（多分）。   

まずはこのブログで使っている[BreadcrumbService](https://github.com/eeenbnb/karaage-ng-site/blob/master/src/app/service/breadcrumb/breadcrumb.service.ts)をNgRX化する。


## Actionを定義する

```typescript
import { createAction, props } from '@ngrx/store';
import { KaraageBreadcrumbs } from 'src/@types/karaage-breadcrumb';

export const setBreadcrumbs = createAction(
  '[breadcrumbs] set',
  props<{breadcrumbs:KaraageBreadcrumbs}>()
);
export const resetBreadcrumbs = createAction('[breadcrumbs] reset');

```

## Reducerを定義する

```typescript
import { createReducer, on } from '@ngrx/store';
import { setBreadcrumbs, resetBreadcrumbs } from './breadcrumb.actions';
import { KaraageBreadcrumbs } from 'src/@types/karaage-breadcrumb';

export const initialBreadcrumbs:KaraageBreadcrumbs = [];

const _breadcrumbsReducer = createReducer(
  initialBreadcrumbs,
  on(setBreadcrumbs, (state,props) => {
    return [...props.breadcrumbs]
  }),
  on(resetBreadcrumbs, (state) => []),
);

export function breadcrumbsReducer(state:any, action:any) {
  return _breadcrumbsReducer(state, action);
}
```

## state を定義する
```typescript
```

## selector を定義する
```typescript
```
